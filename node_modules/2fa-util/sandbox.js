const {authenticator} = require('otplib');

// authenticator.options = {window: 2};
const secret = 'FEESSRR3CVZUSFZA';//authenticator.generateSecret();
console.warn('secret', secret);

const token = authenticator.generate(secret);
console.warn('asdfsadf', authenticator.create({
  ...authenticator.allOptions(),
  window: 2,
}).options);
try {
  console.warn('auth', token, '-> valid ->', authenticator.verify({token, secret}), ` (time: ${authenticator.timeUsed()}/${authenticator.timeRemaining()})`);
  console.warn('check this1: ', authenticator.verify({token: '740768', secret}));
  console.warn('check this2: ', authenticator.create({
    ...authenticator.allOptions(),
    window: 2,
  }).verify({token: '740768', secret}));
} catch (err) {
  // Possible errors
  // - options validation
  // - "Invalid input - it is not base32 encoded string" (if thiry-two is used)
  console.error(err);
}
